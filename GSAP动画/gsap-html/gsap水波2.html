<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>圆点扩散</title>
    <script src="../js/gsap-latest-beta.min.js"></script>
    <script src="../gsap-plugins/GSDevTools3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            background: #313030;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100vw;
        }

        .box {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 0 auto;

        }

        .logo {
            position: absolute;
            top: 210px;
            left: 210px;
            width: 80px;
            height: 80px;
            /* background: #fff; */
            color: #fff;
            font-weight: bold;
            text-align: center;
            line-height: 80px;
            border-radius: 50%;
            margin: 0 auto;
            z-index: 9;
            box-shadow: rgba(0, 0, 0, 0.3) 0px 2px 4px,
                rgba(0, 0, 0, 0.2) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -4px 0px inset;
            background-image: linear-gradient(90deg,
                    rgba(35, 210, 255, 1) 0.3%,
                    rgba(74, 104, 247, 1) 18.2%,
                    rgba(133, 80, 255, 1) 36.4%,
                    rgba(198, 59, 243, 1) 52.5%,
                    rgba(250, 84, 118, 1) 68.8%,
                    rgba(255, 223, 67, 1) 99.9%);
        }

        .animate-wave {
            width: 100%;
            height: 100%;
            position: absolute;
            inset: 0;
            margin: 0 auto;
        }

        .wave-item {
            background: rgb(235, 165, 108);
            position: absolute;
            border-radius: 50%;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 1;
            transform: scale(0);
        }
    </style>

</head>

<body>
    <div class="box" id="btn">
        <div class="logo">LOGO</div>
        <div class="animate-wave">
            <div class="wave-item"></div>
            <div class="wave-item"></div>
            <div class="wave-item"></div>
            <div class="wave-item"></div>
            <div class="wave-item"></div>
            <div class="wave-item"></div>
        </div>
    </div>
</body>
<script>
    gsap.registerPlugin(GSDevTools)

    const tl = gsap.timeline()
    const initScale = 80 / 500;
    gsap.set('.wave-item', {
        // scale: 0,
        scale: initScale,
        opacity: 1,
        transformOrigin: '50% 50%',
        background: `rgba(random(0,255),random(0,255),random(0,255),0.6)`,

    })
    tl.to('.wave-item', {
        duration: 6,
        repeat: -1,
        scale: 1,
        ease: 'none',
        opacity: 0,
        stagger: {
            // amount: 6,
            each: 1,
            from: 'start',
            // stagger 里面的repeat：-1 
            // Repeats immediately, not waiting for the other staggered animations to finish
            repeat: -1,
            // ease: 'power1.out'
            ease: 'power3.int'
        }
    })
    // GSDevTools.create({
    //     animation: boxtl
    // })
</script>

<script>

    // 常用的 howler.js 库播放
    function howlerPlay() {
        var sound2 = new Howl({
            src: ['../images/open.mp3'],
            // autoplay: true,
            // loop: true,
            volume: 0.5,
            // 音频段落
            onend: () => {
                console.log('Finished!');
            },
            onplay: () => {
                console.log('Playing!');
            }
        })
        var sound = new Howl({
            src: ['../images/audio_coin.mp3'],
            autoplay: true,
            // loop: true,
            volume: 0.5,
            // 音频段落
            // sprite: {
            //     explosion: [0, 3000], // 开始位置, 结束位置
            //     laser: [3001, 5000],
            //     powerup: [5001, 7000]
            // },
            onend: () => {
                console.log('Finished!');
                sound2.play();
            },
            onplay: () => {
                console.log('Playing!');
            }
        });
        // Clear listener after first call.
        sound.once('load', function () {
            console.log('loaded!')
            sound.play();
        });

        // sound.play('explosion');
    }

    howlerPlay();

    // 自定义播放声音
    function playSound() {
        // 创建AudioContext对象
        var audioContext = new (window.AudioContext || window.webkitAudioContext)();

        // 加载音频文件
        fetch('../images/audio_coin.mp3')
            .then(response => response.arrayBuffer())
            .then(arrayBuffer => audioContext.decodeAudioData(arrayBuffer))
            .then(audioBuffer => {
                // 创建一个SourceNode，并播放音频
                var source = audioContext.createBufferSource();
                source.buffer = audioBuffer;
                source.connect(audioContext.destination); // 将声音连接到音频上下文的输出（通常是扬声器）
                source.start(0); // 播放音频
            })
            .catch(error => console.log('加载或播放音频时发生错误:', error));
    }

    document.getElementById('btn').addEventListener('click', function () {
        // audio_coin
        console.log('click');
        // playSound();

    })
</script>

</html>